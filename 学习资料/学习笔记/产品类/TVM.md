# TVM

### TVM平台介绍

企业的安全漏洞管理难度不断增加，企业安全漏洞管理面临三个方面的挑战：

1. 漏洞管理环节缺失
2. 应急漏洞响应被动缓慢
3. 互联网暴露资产缺少监管

#### 定义

绿盟威胁和漏洞安全管理平台（NSFOCUS Threat and Vulnerability Management Platform，简称 NSFOCUS TVM）提供漏洞管理的全过程支撑，量化跟踪和分析流程执行情况，促进管理流程持续优化。同时充分利用绿盟科技威胁情报中心（NTI）的漏洞情报信息，由情报触发流程运转，帮助客户建立快速响应机制，及时有效完成漏洞修补工作。

![image-20200803103509686](E:\Typora\Image\image-20200803103509686.png)

绿盟科技脆弱性管理全局观

![image-20200803103603944](E:\Typora\Image\image-20200803103603944.png)

脆弱性评估体系

依据字串、漏洞、威胁等维度，提出脆弱性算法，计算单资产脆弱性值

按照风险木桶权重聚合算法，逐级计算出业务域脆弱性值，体现安全风险的最薄弱环节

![image-20200803103913224](E:\Typora\Image\image-20200803103913224.png)

NTI情报

![image-20200803104006873](E:\Typora\Image\image-20200803104006873.png)

漏洞处置优先级

- 利用外部漏洞威胁情报
- 定位关键风险点
- 重新评估系统安全风险

![image-20200803104055447](E:\Typora\Image\image-20200803104055447.png)

![image-20200803104105012](E:\Typora\Image\image-20200803104105012.png)

### 安装部署

#### 流程

![image-20200803104147793](E:\Typora\Image\image-20200803104147793.png)

#### 配置要求

![image-20200803104303974](E:\Typora\Image\image-20200803104303974.png)

#### 准备工作

![image-20200803104326659](E:\Typora\Image\image-20200803104326659.png)

![image-20200803104426457](E:\Typora\Image\image-20200803104426457.png)

#### 安装TVM

![image-20200803104516623](E:\Typora\Image\image-20200803104516623.png)

#### 部署TVM

打开浏览器，使用https://管理节点IP地址 访问TVM

插入UKey->导证书->配IP->选择TVM模式

#### 登录TVM

- 完成初始化后，自动跳转至登陆页面。默认管理员的用户名和密码的初始值分别为admin和admin
- 初次登陆TVM时，会弹出修改密码对话框，修改完密码后会重新登录TVM。至此，安装部署完成。

#### 卸载TVM

后台进入目录

- cd /opt/nsfocus/espc/bin

执行卸载命令

- ./uninstall

### 资产管理

![image-20200803105201938](E:\Typora\Image\image-20200803105201938.png)

#### 基本操作

##### 资产增加

- 手工录入
    - 单个/批量界面添加资产
    - 离线资产excel导入
- 设备发现
    - 通过扫描器下发资产发现任务（内网资产发现）
    - NTI资产发现（互联网资产发现）

#####  资产删除、修改、查找

- 单个删除/批量删除
- 单个修改/批量修改
- 基础查询/端口查询

##### 共享、转移

- 共享给组/共享给个人
- 只能转移给个人/转移包含风险转移

*共享即不更改资产所属者；转移更改所属者*

*资产可以批量转移，共享只能是单个资产或者全部资产*

*共享给用户A的资产，用户A不可以删除和转移，可以编辑*

##### 资产属性

1. 只有管理属性才可以在管理视图中看到
2. 系统内置的管理属性有4个，管理属性最多有5个
3. 管理属性+非管理属性最多有10个
4. 属性增加后，新建/编辑资产均可见
5. 资产搜索支持属性搜索

##### 资产标签

1. 标签删除|添加的操作，在新建/编辑资产处均可见
2. 资产搜索支持标签搜索

##### 权限

![image-20200803113151299](E:\Typora\Image\image-20200803113151299.png)

##### 资产权限（账号概念区分）

- admin、组高级管理员、组管理员、普通账号A (具有系统管理权限)、 普通账号B (无系统管理权限) 
- admin是超级管理员,默认为每个组的管理员,可以看到系统内所有的资产, 以及资产相关风险;
- 组高级管理员，可以看到自己的资产、组内成员的资产，以及下级分组内所有成员的资产;
- 组管理员，可以看到自己的资产、组内成员的资产;
- 账号A可以看到属于自己的资产、别人共享给他的资产，可以创建资产组;
- 账号B可以看到属于自己的资产、别人共享给他的资产，不能创建资产组,看不到资产组的树形结构。

##### 资产权限（功能操作）

- Admin拥有最大的权限，admin可以将所有的资产共享/转移给别人，可以删除任意资产
- 组管理员可以分享/转移他组下人和他自己的资产。普通成员只可分享他自己的资产，如不能分享页面分享按钮会置灰。
- 普通账号A B只能共享/转移自己的资产; 
- 管理员可以删除自己拥有和他组员拥有的资产。
- 普通用户A、B只可删除自己拥有的资产。
- 不能删除别人共享给自己的资产，在资产管理页面，删除按钮置灰，使用批量删除时则会跳过。

#### 资产应用场景概览

![image-20200803113750067](E:\Typora\Image\image-20200803113750067.png)

##### 从无到有的资产梳理（主动资产发现）

![image-20200803113905392](E:\Typora\Image\image-20200803113905392.png)

##### 内网资产梳理

任务下发->任务查看

##### 互联网资产梳理

用NTI去发现

##### 完成已有资产变更稽查

![image-20200803114247632](E:\Typora\Image\image-20200803114247632.png)

##### 资产稽查

- 新增资产
    - 和稽查对象相比，本次扫描多的资产
- 减少资产
    - 和稽查对象相比，本次扫描减少的资产
- 变更资产
    - 和稽查对象相比，资产IP相同。但是资产信息有变更的资产
- 未涉及资产
    - 当稽查对象设置了IP范围，本次发现的资产不在这个IP范围内
    - 当稽查对象没有设置IP范围，但是资产发现目标没有在稽查对象的IP范围内

### 漏洞管理

#### TVM漏洞声明周期管理过程

##### 线上漏洞管理

![image-20200803114636171](E:\Typora\Image\image-20200803114636171.png)

##### 远程安全评估系统接入

- TVM平台支持接入RSAS，WVSS，WSM-H，BVS安全评估类设备
- 安全评估类设备联动到平台即可，无需配置数据源

##### 选择目标扫描与输入目标扫描

任务管理-扫描任务-创建任务（系统/网站扫描）

- TVM漏洞生命周期管理，是对于TVM已管理的资产而言的；
- 如果输入目标的是一个已有的资产，相当于选择目标下发任务
- 扫描目标是否在资产中，区别在于，是否自动生成漏洞处置单
- 漏洞处置单，是漏洞生命周期管理的入口

![image-20200803141141751](E:\Typora\Image\image-20200803141141751.png)

主机/网站扫描任务会进入漏洞生命周期管理

各类导入任务也会进入漏洞生命周期管理

##### 同步风险与漏洞处置单（1）

- 如何判断是否已生成漏洞处置单---风险是否已同步
- 输入目标方式进行的扫描，也可以在这里进行同步，可以将该资产入库

##### 同步风险与漏洞处置单（2）

漏洞与漏洞处置单的关系

- 漏洞处置单（优先级高中低数）=漏洞出现次数（漏洞高中低数）>=漏洞数量（漏洞统计）
- 漏洞出现次数，是漏洞出现在了不同的端口上，可能不能采取同样的方法进行修复，所以要生成多个处置单

##### 脆弱性评估展示

脆弱性评估是依据处置单为源数据进行的展示，会随漏洞处置单的状态而改变，而非扫描结果

仪表盘页面予以整体展示。

![image-20200803142535876](E:\Typora\Image\image-20200803142535876.png)

##### 漏洞处置单流程简介

类似问题单处理流程，漏洞处置单也有一套处理流程，流程如下图：

F06及之后版本中，可以关闭或开启处置单状态切换规则

![image-20200803142603693](E:\Typora\Image\image-20200803142603693.png)

选择是:

- 绿色箭头，是系统自行进行的，无需/无法人工干预;
- 蓝色箭头,是可以手工进行状态修改的;
- 红色框的状态，计算资产风险;
- 蓝色框的状态，不计算资产风险;
- 当状态不在上述可置状态范围内时，会提示“不支持”

选择否:

- 不能新增处置单，其余状态可任意流转

##### 一次漏洞处理流程（1）

添加资产，进行系统/网站扫描；扫描任务中显示的风险已同步

风险管理中，对应资产的脆弱值已生成

##### 一次漏洞处理流程（2）

在漏洞处置页面，处置单已生成，状态全部为“新增”

##### 一次漏洞处置流程（3）

###### 指派负责人对漏洞进行处置

- 可批量，可单条处置；可转发至其他子账号或者自行处置；
- 可发送邮件通知（F05优化）；可自行编辑优先级（F05新增）
- 处置记录优化（F05优化）；可下发单条/多条漏洞验证任务（F05新增）

##### 一次漏洞处置流程（4）

1. 将漏洞置为不计风险的状态后，当前脆弱值就会下降
2. 重新下发扫描任务，或者下发“漏洞验证”功能，观察漏洞状态

##### 多元数据汇总

支持启明、绿盟RSAS、绿盟WVSS，Nessus扫描数据的导入，导入后，只需要同步资产，也可以进入漏洞生命周期管理 