## 移动应用威胁

###### M1：平台使用不当

包括平台功能的滥用，或未能使用平台的安全控制

包括服务器和客户端的不合理配置和滥用

安全措施：

- 关闭或限制除Web服务的端口（80、443）
- 不暴露后台或中间件登陆页给公网
- 关闭不安全的HTTP方法
- 关闭响应头中的服务器信息
- 设置静态注册组件不可导出

######  M2：不安全的数据存储

- 源码中的敏感信息（如注释、密钥等)
- android:allowBackup属性值
- 数据库文件加密
- shared_prefs目录中敏感信息存储
- 应用中的敏感信息（应用日志、缓存和cookie等)

安全措施：

- 敏感信息存储在服务器
- 上线前去除日志类、注释等
- 数据库、敏感信息加密存储（非密码等信息）
- 关闭所有应用、框架、系统等配置的报错输出

###### M3：不安全的通信

- 使用了早期不安全的传输协议，如SSLv3协议
- 使用弱加密算法，如RC4等
- SSL Pinning 检查：如果安装第三方证书后可以抓取HTTPS流量，说明客户端的代码中未对服务器的证书做校验，存在风险。

安全措施：

- 采用安全的通信协议（HTTPS）
- 对敏感信息加密后进行传输
- 关闭不安全的SSL算法
- 使用SSL Pinning方案

###### M4：不安全的身份验证

- 截屏录屏测试
- 复制粘贴测试（密码禁止复制粘贴功能）
- 程序切换保护
- 本地认证（基于客户端认证）

安全措施：

- 使用自定义安全键盘
- 程序切换后清楚敏感信息
- 采用完整有效的用户身份校验机制
- 对会话设置一定的有效期
- 当检测到用户环境发生变化时及时验证用户身份

###### M5：加密不足

- 不安全的加密算法
- 密钥硬编码（将密钥存储在本地进行编码）
- 自定义加密算法

安全措施：

- 采用有效的加密机制
- 采用合理的密钥方案
- 采用足够强壮的密钥

###### M6：不安全的访问控制

- 逆向分析绕过身份认证
- 逆向分析实现越权
- 水平、垂直越权
- 持久性会话（本地身份认证）
- 暴力破解密码

安全措施：

- 重要功能服务端对用户身份进行校验
- 采用有效的多重校验机制，而非单纯的密码校验

###### M7：客户端代码质量问题

- 跨站脚本编制
- SQL注入（Content Providers）
- XML注入（微信支付的XXE漏洞）
- 路径穿越
- 应用签名



###### M8：代码篡改

本类别包括二进制修补、本地资源修改、方法钩用、方法调整和动态内存修改。

- 重打包(广告，后门木马植入)
- 逻辑篡改

一旦应用程序交付至移动设备，代码和数据资源就都存放在那里。攻击者要么可以直接修改代码、动态修改内存中的内容、更改或替换应用程序使用的系统API，要么可以修改应用程序中的数据和资源。这可以为攻击者提供颠覆本软件用户的使用预期或是获得金钱利益的直接方法。

安全措施：

采用第三方的安全加固对APP进行加壳处理

对应用进行完整性校验：

- 代码中对代码文件（classes.dex）做完整性校验
- 代码中对Apk包做完整性校验
- 代码中对签名文件（META-INF/MANIFEST.MF）中classes.dex哈希值的校验

###### M9：逆向工程

- 包含对核心二进制代码的分析，以确定它的源代码、库文件、算法和其他资产
- 代码混淆检查
- Hook检测（Xposed检测）
- 动态调试（android：debuggable属性值）

安全措施：

采用第三方的安全加固对APP进行加壳处理

对抗静态分析：

- 代码抽取
- 对代码进行混淆处理

对抗动态分析：

- 关闭动态调试
- 检测动态调试

###### M10：无关的功能

通常，开发人员不会打算将隐藏的后门程序功能或其他内部开发安全控件发布到生产环境中

安全措施：

- 开发完成后对代码进行审计，有效减少无关的功能
- 加强开发人员的管理沟通，将问题控制在设计开发阶段