## Web应用安全测试技术

#### 安全测试概述

概念：安全测试是指在企业信息安全工作的框架内，针对特定的目标对象，以攻击者视角通过已知的技术手段进行的技术评估工作的统称

目标：针对企业级的客户，通过发现并揭示风险的方式，指导客户对目标对象进行安全建设

- 行为模式均受到企业信息安全工作的约束
- 需要明确的测试对象。（撒网式测试、不定向测试，不属于安全测试工作的范畴）
- 在有限时间内发现尽可能多的风险（0day挖掘性价比低）
- 测试的目标是为客户进行安全建设提供依据，找漏洞并非本意

###### 网站系统安全测试

针对B/S架构的应用系统，从攻击者的视角，模拟黑客所使用的攻击手段对目标系统进行模拟入侵。同时在保证业务连续性的前提下，测试人员将进行业务功能的深度理解，充分挖掘和暴露应用及业务功能的弱点,从而让管理人员了解其察统所面临的威胁。

###### 接口测试

接口(API)主要分为WEB接口、TCP接口、其他特定接口。2017年，OWASP组织根据近几年安全攻击趋势，发布了OWASPtop 10 (2017)，其中【A10-未受到充分保护的API】为新增的最新十大安全威胁之一。

通用接口安全测试：

权限测试、滥用测试、数据校验测试、数据重放测试、报文篡改测试、报文保密测试、信息泄露测试

其他安全测试：

XML实体注入、SQL注入、业务逻辑测试

流程：稳定接口测试目标、收集接口测试信息、实施接口安全测试、接口测试报告编写

多维度风险规避：

- 时间：避免在数据高峰时进行测试，以此来减小测试工作对被测试系统带来的压力
- 工具：通过设置线程、插件数量等参数来减少其对系统的压力，同时还会去除任何可能对目标系统带来危害的插件
- 手段：每一步测试前都会预估可能带来的后果，对于可能产生影响的测试（如：溢出攻击）将被记录并跳过
- 监控：每一系统测试前，告知被测试系统管理员，并且在测试过程中随时关注目标系统的负荷等信息，一旦出现任何异常，将会停止测试
- 目标：为更大程度的避免风险的产生，渗透测试还可选择对备份系统进行测试
- 沟通：测试过程中，确定测试人员和客户方配合人员的联系方式，至少两种以上，便于及时沟通并解决工程中的难点

#### Web安全测试方法

安全测试流程：明确目标->信息收集->漏洞探测->漏洞验证->信息分析->获取所需->信息整理->形成报告



业务功能梳理：梳理和测试异步进行，首先进行全系统的业务功能梳理，识别出数据&流程确实的功能模块并进行记录

覆盖情况反馈：将业务功能梳理的情况反馈给测试及开发人员

数据&流程补足：由对应人员提供缺失部分的数据&流程，或将部分测试移至非生产环境中进行

- 数据&流程补足意义在于更深入的遍历业务功能。一些重要的复杂系统甚至需要经过多次数据&流程补足工作

安全测试：依据补足后的业务功能梳理结合威胁列表进行功能场景威胁导出



安全测试基本流程：信息收集->安全测试->缺陷利用->威胁分析

依赖于个体测试经验

最依赖的三个点：

1. 测试对象———为什么关注这个功能而不是那个?（拳脚)
2. 测试方法——为什么这个点要测试注入而不是跨站?(招式)
3. 测试深度——为什么这个过滤别人能绕过而你绕过不了?(内功)

传统渗透测试具备极大的不定性，因此该项工作的目标是站在黑客视角尽可能找出可被利用问题而非是找出所有安全问题

#### web应用安全测试技术

信息收集-端口信息

![image-20200715095724665](E:\Typora\Image\image-20200715095724665.png)

![image-20200715095736502](E:\Typora\Image\image-20200715095736502.png)

目录探测-破壳扫描器

常见后台及控制台地址

![image-20200715095807936](E:\Typora\Image\image-20200715095807936.png)

web应用漏洞扫描--AWVS

文件上传防护：

建议在不影响业务的前提下
1、服务器端添加上传文件类型“白名单”。校验功能，仅允许业务需求类型上传
2、服务器端添加上传文件名特殊字符过滤机制;防止特殊字符引起的文件解析漏洞
3、服务器端添加上传文件重命名机制，包含文件后缀格式重命名
4、服务器端添加上传文件内容识别机制，防止恶意文件伪装图片等类型文件上传
5、服务器端单独创建上传目录，并限制目录解析权限，杜绝目录解析网页类型文件



 SQL注入语法在后面接 --+可以注释掉后面的语句

![image-20200715103053770](E:\Typora\Image\image-20200715103053770.png)

CSRF与XSS区别

攻击流程：

![image-20200715104031156](E:\Typora\Image\image-20200715104031156.png)

区别：

![image-20200715104043820](E:\Typora\Image\image-20200715104043820.png)